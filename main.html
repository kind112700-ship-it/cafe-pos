<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´í˜ POS ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
    <div id="pos-container">

        <div id="menu-area">
            <div class="category-tabs">
                <button class="tab active" data-category="COFFEE">COFFEE</button>
                <button class="tab" data-category="BEVERAGE">BEVERAGE</button>
                <button class="tab" data-category="TEA">TEA</button>
                <button class="tab" data-category="FRAPPUCCINO">FRAPPUCCINO</button>
                <button class="tab" data-category="AED">AED</button>
            </div>

            <div class="item-grid">

                <button class="item-card" data-id="1" data-category="COFFEE">
                    <span class="item-name">ì—ìŠ¤í”„ë ˆì†Œ</span>
                    <span class="item-price">3,500</span>
                </button>
                <button class="item-card" data-id="2" data-category="COFFEE">
                    <span class="item-name">ì•„ë©”ë¦¬ì¹´ë…¸</span>
                    <span class="item-price">3,500</span>
                </button>
                <button class="item-card" data-id="3" data-category="COFFEE">
                    <span class="item-name">ì•„ì¸ìŠˆí˜ë„ˆ</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="4" data-category="COFFEE">
                    <span class="item-name">ì¹´í˜ë¼ë–¼</span>
                    <span class="item-price">4,000</span>
                </button>
                <button class="item-card" data-id="5" data-category="COFFEE">
                    <span class="item-name">ì¹´í‘¸ì¹˜ë…¸</span>
                    <span class="item-price">4,000</span>
                </button>
                <button class="item-card" data-id="6" data-category="COFFEE">
                    <span class="item-name">ë°”ë‹ë¼ë¼ë–¼</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="7" data-category="COFFEE">
                    <span class="item-name">í—¤ì´ì¦ë„›ë¼ë–¼</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="8" data-category="COFFEE">
                    <span class="item-name">ì¹´ë¼ë©œë§ˆë¼ì•¼ë˜</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="9" data-category="COFFEE">
                    <span class="item-name">ì¹´í˜ëª¨ì¹´</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="10" data-category="COFFEE">
                    <span class="item-name">ëŒì²´ë¼ë–¼</span>
                    <span class="item-price">4,500</span>
                </button>
                <button class="item-card" data-id="11" data-category="COFFEE">
                    <span class="item-name">ë§ì°¨ì¹´í˜ë¼ë–¼</span>
                    <span class="item-price">5,000</span>
                </button>

                <button class="item-card" data-id="12" data-category="BEVERAGE">
                    <span class="item-name">ì•„ìŒˆë°€í¬í‹°</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="13" data-category="BEVERAGE">
                    <span class="item-name">ë¡œì–„ë°€í¬í‹°</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="14" data-category="BEVERAGE">
                    <span class="item-name">ë§ì°¨ë¼ë–¼</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="15" data-category="BEVERAGE">
                    <span class="item-name">ì´ˆì½”ë¼ë–¼</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="17" data-category="BEVERAGE">
                    <span class="item-name">ì˜¤ê³¡ë¼ë–¼</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="18" data-category="BEVERAGE">
                    <span class="item-name">ê³ êµ¬ë§ˆë¼ë–¼</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="19" data-category="BEVERAGE">
                    <span class="item-name">ë”¸ê¸°ë¼ë–¼</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="20" data-category="BEVERAGE">
                    <span class="item-name">ë°”ë‚˜ë‚˜ë¼ë–¼</span>
                    <span class="item-price">5,500</span>
                </button>

                <button class="item-card" data-id="21" data-category="TEA">
                    <span class="item-name">ì–¼ê·¸ë ˆì´</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="22" data-category="TEA">
                    <span class="item-name">ì‰ê¸€ë¦¬ì‰¬ë¸”ë™í‹°</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="23" data-category="TEA">
                    <span class="item-name">ë‹¤ì¦ë§</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="24" data-category="TEA">
                    <span class="item-name">ìºëª¨ë§ˆì¼</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="25" data-category="TEA">
                    <span class="item-name">í˜í¼ë¯¼íŠ¸</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="26" data-category="TEA">
                    <span class="item-name">ë£¨ì´ë³´ìŠ¤</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="27" data-category="TEA">
                    <span class="item-name">ë ˆëª¬ì°¨</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="28" data-category="TEA">
                    <span class="item-name">ìëª½ì°¨</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="29" data-category="TEA">
                    <span class="item-name">ìœ ìì°¨</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="30" data-category="TEA">
                    <span class="item-name">ì•„ì´ìŠ¤í‹°</span>
                    <span class="item-price">5,000</span>
                </button>

                <button class="item-card" data-id="31" data-category="FRAPPUCCINO">
                    <span class="item-name">ë”¸ê¸°ìŠ¤ë¬´ë””</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="32" data-category="FRAPPUCCINO">
                    <span class="item-name">ë§ê³ ìŠ¤ë¬´ë””</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="33" data-category="FRAPPUCCINO">
                    <span class="item-name">ë¸”ë£¨ë² ë¦¬ìŠ¤ë¬´ë””</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="34" data-category="FRAPPUCCINO">
                    <span class="item-name">ìš”ê±°íŠ¸ìŠ¤ë¬´ë””</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="35" data-category="FRAPPUCCINO">
                    <span class="item-name">ëª¨ì¹´í”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="36" data-category="FRAPPUCCINO">
                    <span class="item-name">ì¹´ë¼ë©œí”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="37" data-category="FRAPPUCCINO">
                    <span class="item-name">ì´ˆì½”í”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="38" data-category="FRAPPUCCINO">
                    <span class="item-name">ë¯¼íŠ¸ì´ˆì½”í”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="39" data-category="FRAPPUCCINO">
                    <span class="item-name">ë§ì°¨í”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>
                <button class="item-card" data-id="40" data-category="FRAPPUCCINO">
                    <span class="item-name">ì¿ ì•¤í¬í”„ë¼í˜</span>
                    <span class="item-price">5,500</span>
                </button>

                <button class="item-card" data-id="41" data-category="AED">
                    <span class="item-name">ë ˆëª¬ì—ì´ë“œ</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="42" data-category="AED">
                    <span class="item-name">ìëª½ì—ì´ë“œ</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="43" data-category="AED">
                    <span class="item-name">ì²­í¬ë„ì—ì´ë“œ</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="44" data-category="AED">
                    <span class="item-name">ì²´ë¦¬ì—ì´ë“œ</span>
                    <span class="item-price">5,000</span>
                </button>
                <button class="item-card" data-id="45" data-category="AED">
                    <span class="item-name">ë¼ì„ì—ì´ë“œ</span>
                    <span class="item-price">5,000</span>
                </button>
            </div>
        </div>

        <div id="order-area">

            <div class="order-header">
                <h2>ì£¼ë¬¸ ëª©ë¡</h2>
                <span class="order-count">ì´ 2ê°œ í•­ëª©</span>
            </div>

            <ul class="order-list">
                <li class="order-item">
                    <span class="item-title">ì•„ë©”ë¦¬ì¹´ë…¸ (I)</span>
                    <span class="item-qty">x 1</span>
                    <span class="item-subtotal">3,500</span>
                </li>
                <li class="order-item selected">
                    <span class="item-title">ì¹´í˜ ë¼ë–¼ (H)</span>
                    <span class="item-qty">x 2</span>
                    <span class="item-subtotal">9,000</span>
                </li>
            </ul>

            
            <div class="action-row">
                <button class="func-btn number">-</button>
                <button class="func-btn number count">1</button>
                <button class="func-btn number">+</button>
                <button class="func-btn delete">í•­ëª© ì‚­ì œ</button>
            </div>
            <div class="total-row">
                <span>ì´ ê²°ì œ ê¸ˆì•¡ (Total)</span>
                <span id="grand-total-display">12,500ì›</span>
            </div>
            <a id="checkout-btn" href="./cart.html">
                ì£¼ë¬¸í•˜ê¸° (Checkout)
            </a>
        </div>

        <div id="option-modal" class="modal-backdrop hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-item-name"></h3>
                    <span id="modal-item-base-price"></span>
                </div>

                <div class="modal-body">
                    <div class="modal-option-group">
                        <h4>ì˜¨ë„ ë° ê¸°ë³¸ ì˜µì…˜</h4>
                        <div class="option-row" id="modal-temp-size-options">
                            <button class="modal-opt-btn" data-type="temp" data-value="HOT">HOT</button>
                            <button class="modal-opt-btn active" data-type="temp" data-value="ICE">ICE</button>
                            <button class="modal-opt-btn" data-type="modifier" data-value="ì‚¬ì´ì¦ˆ UP">ì‚¬ì´ì¦ˆ UP
                                (+500)</button>
                            <button class="modal-opt-btn" data-type="modifier" data-value="ìƒ· ì¶”ê°€">ìƒ· ì¶”ê°€ (+500)</button>
                        </div>
                    </div>

                    <div class="modal-option-group">
                        <h4>ì¶”ê°€ ì„ íƒ ì‚¬í•­</h4>
                        <div class="modifier-grid" id="modal-modifier-options">
                            <button class="modal-mod-btn" data-type="modifier" data-value="ì‹œëŸ½ ì¶”ê°€ (+500)">ì‹œëŸ½ ì¶”ê°€
                                (+500)</button>
                            <button class="modal-mod-btn" data-type="modifier" data-value="íœ˜í•‘ ì¶”ê°€ (+500)">íœ˜í•‘ ì¶”ê°€
                                (+500)</button>
                            <button class="modal-mod-btn" data-type="modifier" data-value="ë‘ìœ  ë³€ê²½ (+500)">ë‘ìœ  ë³€ê²½
                                (+500)</button>
                            <button class="modal-mod-btn" data-type="modifier" data-value="ì €ì§€ë°© ìš°ìœ ">ì €ì§€ë°© ìš°ìœ </button>
                            <button class="modal-mod-btn" data-type="modifier" data-value="ì—°í•˜ê²Œ">ì—°í•˜ê²Œ</button>
                            <button class="modal-mod-btn" data-type="modifier" data-value="ì§„í•˜ê²Œ">ì§„í•˜ê²Œ</button>
                        </div>
                        <div id="memo-options" class="option-content">
                            <textarea id="modal-memo-input" placeholder="ìš”ì²­ ë©”ëª¨ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”" rows="3"
                                style="width: 100%; padding: 8px; box-sizing: border-box;"></textarea>
                        </div>
                    </div>

                    <div class="modal-qty-group">
                        <h4>ìˆ˜ëŸ‰</h4>
                        <div class="action-row modal-qty-controls">
                            <button id="modal-qty-minus" class="func-btn number">-</button>
                            <span id="modal-qty-display" class="func-btn number count">1</span>
                            <button id="modal-qty-plus" class="func-btn number">+</button>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button id="modal-cancel-btn">ì·¨ì†Œ</button>
                    <button id="modal-add-to-order-btn">ì£¼ë¬¸ ë‹´ê¸°</button>
                </div>
            </div>
        </div>

    </div>




    <script>
        $(function () {
            // ìƒí’ˆ ë°ì´í„° ë° ì˜µì…˜ ê°€ê²© ì •ì˜
            const MENU_ITEMS = {};
            $('.item-grid .item-card').each(function () {
                const id = $(this).data('id').toString();
                const name = $(this).find('.item-name').text();
                const priceText = $(this).find('.item-price').text().replace(/,/g, '');
                const price = parseInt(priceText, 10);
                MENU_ITEMS[id] = { id, name, price, category: $(this).data('category') };
            });

            const MODIFIER_PRICES = {
                'ì‚¬ì´ì¦ˆ UP': 500,
                'ìƒ· ì¶”ê°€': 500,
                'ì‹œëŸ½ ì¶”ê°€ (+500)': 500,
                'íœ˜í•‘ ì¶”ê°€ (+500)': 500,
                'ë‘ìœ  ë³€ê²½ (+500)': 500,
                'ì €ì§€ë°© ìš°ìœ ': 0,
                'ì—°í•˜ê²Œ': 0,
                'ì§„í•˜ê²Œ': 0
            };

            let currentOrder = {};
            let selectedItemId = null;
            let nextUniqueId = 1; // ì£¼ë¬¸ í•­ëª©ì˜ ê³ ìœ  ID ìƒì„±ìš©
            let modalItem = {}; // ëª¨ë‹¬ ë‚´ì—ì„œ ì„ì‹œë¡œ ì˜µì…˜ì„ ì €ì¥í•  ê°ì²´


            // ----------------------------------------------------
            // [í•¨ìˆ˜] ëª¨ë‹¬ ê´€ë ¨ ë¡œì§
            // ----------------------------------------------------
            function openModal(itemId) {
                const itemInfo = MENU_ITEMS[itemId];
                if (!itemInfo) return;

                // 1. ì„ì‹œ ì£¼ë¬¸ ê°ì²´ ì´ˆê¸°í™” (ê¸°ë³¸ê°’ ì„¤ì •)
                modalItem = {
                    baseId: itemId,
                    name: itemInfo.name,
                    price: itemInfo.price,
                    qty: 1,
                    temp: 'ICE',
                    modifiers: [],
                    memo: ''
                };

                // 2. ëª¨ë‹¬ UI ì—…ë°ì´íŠ¸ ë° ì´ˆê¸°í™”
                $('#modal-item-name').text(itemInfo.name);
                $('#modal-item-base-price').text(itemInfo.price.toLocaleString('ko-KR') + 'ì›');
                $('#modal-qty-display').text(1);
                $('#modal-memo-input').val('');

                // ì˜µì…˜ ë²„íŠ¼ ì´ˆê¸°í™” ë° ê¸°ë³¸ê°’(ICE) í™œì„±í™”
                $('.modal-opt-btn, .modal-mod-btn').removeClass('active');
                $(`.modal-opt-btn[data-value="ICE"]`).addClass('active');

                // 3. ëª¨ë‹¬ í‘œì‹œ
                $('#option-modal').removeClass('hidden');
            }

            function closeModal() {
                $('#option-modal').addClass('hidden');
                // $('#memo-options').removeClass('hidden');
            }

            // ----------------------------------------------------
            // [í•¨ìˆ˜] ì£¼ë¬¸ ìš”ì•½ ë° UI ì—…ë°ì´íŠ¸
            // ----------------------------------------------------
            function updateOrderSummary() {
                let grandTotal = 0;
                $('.order-list').empty();

                const orderKeys = Object.keys(currentOrder).sort((a, b) => parseInt(a) - parseInt(b));

                for (const uniqueId of orderKeys) {
                    const item = currentOrder[uniqueId];

                    // ê¸°ë³¸ ê°€ê²© + ì˜µì…˜ ê°€ê²© ê³„ì‚°
                    let itemPrice = item.price;
                    let modifierDetailsHtml = '';
                    let modifierNamesWithPrice = []; // ì˜µì…˜ ì´ë¦„ ë° ê°€ê²©ì„ ì €ì¥í•  ë°°ì—´

                    if (item.modifiers && Array.isArray(item.modifiers)) {
                        item.modifiers.forEach(modifier => {
                            const modPrice = MODIFIER_PRICES[modifier] || 0;
                            itemPrice += modPrice;

                            let priceDisplay = (modPrice > 0) ? ` (+${modPrice.toLocaleString('ko-KR')})` : '';

                            // ì˜µì…˜ ì´ë¦„(ê´„í˜¸ ì œê±°)ê³¼ ê°€ê²©ì„ ê²°í•©í•˜ì—¬ ë°°ì—´ì— ì €ì¥
                            modifierNamesWithPrice.push(modifier.replace(/\s?\(\+\d+?\)/g, '') + priceDisplay);
                        });

                        // ì˜µì…˜ì´ ìˆì„ ê²½ìš°, ìƒˆë¡œìš´ ì¤„ì— í‘œì‹œë  HTML êµ¬ì¡° ìƒì„±
                        if (modifierNamesWithPrice.length > 0) {
                            modifierDetailsHtml = `<div class="modifier-list-line">â¨½ ${modifierNamesWithPrice.join(', ')}</div>`;
                        }
                    }

                    // â­ï¸ ì¶”ê°€: ë©”ëª¨ í‘œì‹œë¥¼ ìœ„í•œ HTML ë³€ìˆ˜ ìƒì„± â­ï¸
                    let memoHtml = '';
                    if (item.memo && item.memo.length > 0) {
                        memoHtml = `<div class="modifier-list-line memo-line">ğŸ“ ìš”ì²­: ${item.memo}</div>`;
                    }

                    const subtotal = itemPrice * item.qty;
                    grandTotal += subtotal;

                    const selectedClass = (uniqueId === selectedItemId) ? ' selected' : '';
                    const tempDisplay = item.temp ? ` (${item.temp.charAt(0)})` : '';

                    // â­ï¸ ì˜µì…˜ê³¼ ë©”ëª¨ HTMLì„ ëª¨ë‘ í¬í•¨í•˜ë„ë¡ ìˆ˜ì • â­ï¸
                    const orderHtml = `
            <li class="order-item${selectedClass}" data-id="${uniqueId}">
                <div class="main-info">
                    <span class="item-title">${item.name}${tempDisplay}</span>
                    <span class="item-qty">x ${item.qty}</span>
                    <span class="item-subtotal">${subtotal.toLocaleString('ko-KR')}</span>
                </div>
                ${modifierDetailsHtml} 
                ${memoHtml} 
            </li>
        `;
                    $('.order-list').append(orderHtml);
                }

                $('.order-count').text(`ì´ ${orderKeys.length}ê°œ í•­ëª©`);
                $('#grand-total-display').text(grandTotal.toLocaleString('ko-KR') + 'ì›');

                updateCountDisplay();
                updateOptionPanel();
                $('#checkout-btn').prop('disabled', orderKeys.length === 0);
            }
            function updateCountDisplay() {
                // í•˜ë‹¨ íŒ¨ë„ ìˆ˜ëŸ‰ í‘œì‹œ ë° ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
                if (selectedItemId && currentOrder[selectedItemId]) {
                    const qty = currentOrder[selectedItemId].qty;
                    $('.func-btn.number.count').text(qty);
                    $('.action-row .func-btn.number:contains("-")').prop('disabled', qty <= 1);
                    $('.action-row .func-btn.number:contains("+")').prop('disabled', false);
                    $('.func-btn.delete').prop('disabled', false);
                } else {
                    $('.func-btn.number.count').text('0');
                    $('.action-row .func-btn.number, .func-btn.delete').prop('disabled', true);
                }
            }

            function updateOptionPanel() {
                // í•˜ë‹¨ ì˜µì…˜ íŒ¨ë„ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì„ íƒëœ í•­ëª©ì˜ ì˜µì…˜ ìƒíƒœ ë°˜ì˜)
                $('.function-panel button.option, .function-panel button.mod-btn').removeClass('active');
                if (!selectedItemId || !currentOrder[selectedItemId]) return;

                const item = currentOrder[selectedItemId];

                if (item.temp) {
                    $(`#temp-options .func-btn.option:contains("${item.temp}")`).addClass('active');
                }
                if (item.modifiers && Array.isArray(item.modifiers)) {
                    item.modifiers.forEach(modifier => {
                        $(`.func-btn.option:contains("${modifier}")`).addClass('active');
                        $(`.mod-btn:contains("${modifier}")`).addClass('active');
                    });
                }
            }


            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 1. ë©”ë‰´ í•­ëª© í´ë¦­ -> ëª¨ë‹¬ ì—´ê¸° â­ï¸ë¡œì§ ë³€ê²½â­ï¸
            // ----------------------------------------------------
            $('.item-grid').on('click', '.item-card', function () {
                const itemId = $(this).data('id').toString();
                openModal(itemId);
            });

            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 2. ëª¨ë‹¬ ë‚´ ì˜µì…˜/ìˆ˜ëŸ‰ ì¡°ì ˆ â­ï¸ìƒˆ ë¡œì§â­ï¸
            // ----------------------------------------------------
            $('#option-modal').on('click', '.modal-opt-btn, .modal-mod-btn', function () {
                const type = $(this).data('type');
                const value = $(this).data('value');

                if (type === 'temp') {
                    modalItem.temp = value;
                    $('#modal-temp-size-options .modal-opt-btn[data-type="temp"]').removeClass('active');
                    $(this).addClass('active');
                } else if (type === 'modifier') {
                    const index = modalItem.modifiers.indexOf(value);

                    if (index > -1) {
                        modalItem.modifiers.splice(index, 1);
                        $(this).removeClass('active');
                    } else {
                        modalItem.modifiers.push(value);
                        $(this).addClass('active');
                    }
                }
            });

            $('#modal-qty-plus').on('click', function () {
                modalItem.qty += 1;
                $('#modal-qty-display').text(modalItem.qty);
            });

            $('#modal-qty-minus').on('click', function () {
                if (modalItem.qty > 1) {
                    modalItem.qty -= 1;
                    $('#modal-qty-display').text(modalItem.qty);
                }
            });

            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 3. ëª¨ë‹¬ 'ì£¼ë¬¸ ë‹´ê¸°' -> ìµœì¢… ì£¼ë¬¸ ëª©ë¡ì— ì¶”ê°€ â­ï¸ìƒˆ ë¡œì§â­ï¸
            // ----------------------------------------------------
            $('#modal-add-to-order-btn').on('click', function () {
                modalItem.memo = $('#modal-memo-input').val().trim();
                const uniqueId = (nextUniqueId++).toString();

                // ê¹Šì€ ë³µì‚¬ë¡œ ìƒˆë¡œìš´ ì£¼ë¬¸ í•­ëª© ìƒì„±
                currentOrder[uniqueId] = JSON.parse(JSON.stringify(modalItem));
                currentOrder[uniqueId].id = uniqueId;

                selectedItemId = uniqueId;

                updateOrderSummary();
                closeModal();
            });

            // [ì´ë²¤íŠ¸] ëª¨ë‹¬ 'ì·¨ì†Œ' ë²„íŠ¼
            $('#modal-cancel-btn').on('click', closeModal);

            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 4. ì£¼ë¬¸ í•­ëª© ì„ íƒ ë° ìˆ˜ëŸ‰/ì‚­ì œ ì²˜ë¦¬ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            // ----------------------------------------------------
            $('.order-list').on('click', '.order-item', function () {
                $('.order-list .order-item').removeClass('selected');
                $(this).addClass('selected');
                selectedItemId = $(this).data('id').toString();

                updateCountDisplay();
                updateOptionPanel();
            });

            $('.action-row .func-btn.number:not(.count)').on('click', function () {
                if (!selectedItemId || !currentOrder[selectedItemId]) return;
                const item = currentOrder[selectedItemId];
                const action = $(this).text().trim();
                if (action === '+') item.qty += 1;
                else if (action === '-') { if (item.qty > 1) item.qty -= 1; }
                updateOrderSummary();
            });

            $('.func-btn.delete').on('click', function () {
                if (!selectedItemId || !currentOrder[selectedItemId]) return;
                delete currentOrder[selectedItemId];
                selectedItemId = null;
                updateOrderSummary();
            });


            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 5. í•˜ë‹¨ ì˜µì…˜ íŒ¨ë„ í´ë¦­ (ì´ë¯¸ ì£¼ë¬¸ëœ í•­ëª©ì˜ ì˜µì…˜ ìˆ˜ì •) â­ï¸ë¡œì§ ìœ ì§€â­ï¸
            // ----------------------------------------------------
            $('.function-panel').on('click', '.option:not(:contains("HOT")):not(:contains("ICE")), .mod-btn', function () {
                if (!selectedItemId || !currentOrder[selectedItemId]) {
                    alert('ë¨¼ì € ì£¼ë¬¸ ëª©ë¡ì—ì„œ í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                const optionName = $(this).text().trim();
                const item = currentOrder[selectedItemId];
                if (!item.modifiers) item.modifiers = [];

                const index = item.modifiers.indexOf(optionName);

                if (index > -1) {
                    item.modifiers.splice(index, 1);
                    $(this).removeClass('active');
                } else {
                    item.modifiers.push(optionName);
                    $(this).addClass('active');
                }

                updateOrderSummary();
            });

            // ì˜¨ë„ ì˜µì…˜ (HOT/ICE) ìˆ˜ì •
            $('#temp-options .func-btn.option:contains("HOT"), #temp-options .func-btn.option:contains("ICE")').on('click', function () {
                if (!selectedItemId || !currentOrder[selectedItemId]) {
                    alert('ë¨¼ì € ì£¼ë¬¸ ëª©ë¡ì—ì„œ í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                currentOrder[selectedItemId].temp = $(this).text().trim();
                updateOrderSummary();
            });


            // ----------------------------------------------------
            // [ì´ë²¤íŠ¸] 6. ì¹´í…Œê³ ë¦¬ íƒ­ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            // ----------------------------------------------------
            $('.category-tabs .tab').on('click', function () {
                const category = $(this).data('category');
                $('.category-tabs .tab').removeClass('active');
                $(this).addClass('active');
                $('.item-grid .item-card').each(function () {
                    $(this).data('category') === category ? $(this).show() : $(this).hide();
                });
            });

            $('.function-panel .opt-tab').on('click', function () {
                const targetContentId = $(this).data('content');
                $('.function-panel .opt-tab').removeClass('active');
                $(this).addClass('active');
                $('.function-panel .option-content').removeClass('active').addClass('hidden');
                $(`#${targetContentId}`).removeClass('hidden').addClass('active');
            });

            // ----------------------------------------------------
            // [ì´ˆê¸°í™”] í˜ì´ì§€ ë¡œë“œ ì‹œ
            // ----------------------------------------------------
            // ì´ˆê¸°í™” ì½”ë“œ ì¤‘ë³µ ì œê±° ë° ìµœì¢… ì •ë¦¬
            currentOrder = {};
            selectedItemId = null;
            nextUniqueId = 1;
            updateOrderSummary();

            // ì¹´í…Œê³ ë¦¬ ì •ë ¬ì„ ìœ„í•´ COFFEE íƒ­ì„ ê°•ì œë¡œ í´ë¦­
            $('.category-tabs .tab.active[data-category="COFFEE"]').trigger('click');
            // ì˜µì…˜ íŒ¨ë„ ì´ˆê¸° íƒ­ í‘œì‹œ
            $('.function-panel .opt-tab.active').trigger('click');
        });


    </script>
</body>

</html>